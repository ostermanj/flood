!function i(a,s,c){function u(r,e){if(!s[r]){if(!a[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(l)return l(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var o=s[r]={exports:{}};a[r][0].call(o.exports,function(e){var t=a[r][1][e];return u(t||e)},o,o.exports,i,a,s,c)}return s[r].exports}for(var l="function"==typeof require&&require,e=0;e<c.length;e++)u(c[e]);return u}({1:[function(s,e,t){"use strict";var b=s("../js-exports/Bars");s("../js-vendor/d3-tip"),s("../js-vendor/polyfills");function m(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}window.theMap=function(){if(e=0,null==function(){try{var e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(e){return!1}}()&&d3.select("#webgl-warning").classed("warning",!0).append("li").text("Your device may not support the graphics this tool relies on; please try on another."),"function"==typeof Map&&"function"==typeof Set||(e++,d3.select("#webgl-warning").classed("warning",!0).append("li").text("Your browser is out of date and will have trouble loading this feature. Weâ€™re showing you an image instead. Please try another browser."),d3.select("#webgl-warning").append("img").attr("src","assets/flood-insurance-policy-map.png")),!(0<e)){var e;mapboxgl.accessToken="pk.eyJ1Ijoib3N0ZXJtYW5qIiwiYSI6ImNpdnU5dHVndjA2eDYyb3A3Nng1cGJ3ZXoifQ.Xo_k-kzGfYX_Yo_RDcHDBg",d3.selectAll(".help-link").on("click",function(){d3.event.preventDefault()});var u,t=s("mapbox-helper"),l=d3.tip().attr("class","d3-tip").direction("w").html(function(e){return e[d3.select(this.parentNode.parentNode.parentNode).attr("id").replace("-","")]}),f=[],p=new Map,d=0,r=8,n=new mapboxgl.Map({container:"map",style:"mapbox://styles/ostermanj/cjf03o37b3tve2rqp2inw6a1f",center:[-96.6434921115092,37.98467337085599],zoom:3,maxBounds:[[-142.88705714746362,16.058344948432406],[-51.9023017869731,55.76690067417138]],minZoom:1.5,attributionControl:!1}),o=new mapboxgl.NavigationControl({showCompass:!1});n.addControl(o,"top-right");var i,h=new Map;n.on("load",function(){t.addSourceAndLayers.call(n,{name:"policy-points",type:"vector",url:"mapbox://ostermanj.63wez16h"},[{id:"points",type:"circle",source:"policy-points","source-layer":"policies",maxzoom:r,paint:{"circle-color":["match",["get","t_ded"],5,"#0f439c","#990000"],"circle-radius":{stops:[[5,3],[8,18]]},"circle-opacity":.1}},{id:"points-data-driven",type:"circle",source:"policy-points","source-layer":"policies",minzoom:r,paint:{"circle-color":["match",["get","t_ded"],5,"#0f439c","#990000"],"circle-radius":{property:"prem",type:"exponential",stops:[[62,5],[2500,60]]},"circle-opacity":.1,"circle-stroke-color":"#ffffff","circle-stroke-width":1}}]),d++,g()}),i="http://www.rff.org/files/policies.csv",d3.csv(i,function(e,t){if(e)throw e;var r,n,o,i,a,s=[];t.forEach(function(e){var t=+e.med_income?+e.med_income:null;h.has(+e.cen_tract)||h.set(+e.cen_tract,t);var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=isNaN(+e[n])?e[n]:+e[n]);p.set(r.id,r),s.push({type:"Feature",properties:r,geometry:{type:"Point",coordinates:[+e.longitude,+e.latitude]}})}),u={type:"FeatureCollection",features:s},d3.select("div.bar-charts").classed("load",!1),f.push(new b.Bars.Bar({title:"Properties in view",margin:{top:0,right:1,bottom:0,left:1},heightToWidth:.05,container:"#in-view-bar",data:u.features,numerator:function(e){return e.size},denominator:function(){return this.data.length},textFunction:function(e,t){return d3.format(",")(e)+" of "+d3.format(",")(t)+" ("+d3.format(".0%")(e/t)+")"}}),new b.Bars.Bar({title:"... with low deductible",margin:{top:0,right:1,bottom:0,left:1},heightToWidth:.05,infoMark:!0,container:"#deductible-bar",data:u.features,numerator:function(t){if(0===t.size)return this.min;var e=this.data.filter(function(e){return t.has(e.properties.id)}),r=0;return e.forEach(function(e){e.properties.t_ded<5&&r++}),r},denominator:function(e){return e.size},textFunction:function(e,t){return 0===y.size?"none in view":d3.format(",")(e)+" of "+d3.format(",")(t)+" ("+d3.format(".0%")(e/t)+")"}}),new b.Bars.Bar({title:"Average premium",margin:{top:0,right:1,bottom:0,left:1},zScores:v("prem",2e3),min:function(){return this.zScores.min},heightToWidth:.05,container:"#premium-bar",data:u.features,numerator:function(t){if(0===t.size)return this.min;var e=this.data.filter(function(e){return t.has(e.properties.id)});return d3.mean(e,function(e){return e.properties.premZ})},denominator:function(){return this.zScores.max},textFunction:function(e){return 0===y.size?"none in view":"$"+d3.format(",.2f")(this.zScores.mean+this.zScores.sd*e)+" (z = "+d3.format(".2f")(e)+")"}}),new b.Bars.Bar({title:"Average home replacement value",margin:{top:0,right:1,bottom:0,left:1},zScores:v("value",550,2e4,[250]),min:function(){return this.zScores.min},infoMark:!0,heightToWidth:.05,container:"#value-bar",data:u.features,numerator:function(t){if(0===t.size)return this.min;var e=this.data.filter(function(e){return t.has(e.properties.id)});return d3.mean(e,function(e){return e.properties.valueZ})},denominator:function(){return this.zScores.max},textFunction:function(e){return 0===y.size?"none in view":"$"+d3.format(",.0f")(1e3*(this.zScores.mean+this.zScores.sd*e))+" (z = "+d3.format(".2f")(e)+")"}}),new b.Bars.Bar({title:"Average flood insurance coverage",margin:{top:0,right:1,bottom:0,left:1},infoMark:!0,zScores:v("tcov",null,null,[]),min:function(){return this.zScores.min},heightToWidth:.05,container:"#coverage-bar",data:u.features,numerator:function(t){return 0===t.size?this.min:(this.filteredData=this.data.filter(function(e){return t.has(e.properties.id)}),d3.mean(this.filteredData,function(e){return e.properties.tcovZ}))},denominator:function(){return this.zScores.max},textFunction:function(e){return 0===y.size?"none in view":"$"+d3.format(",.0f")(1e3*(this.zScores.mean+this.zScores.sd*e))+" (z = "+d3.format(".2f")(e)+")"}}),new b.Bars.Bar({title:"Average median household income",margin:{top:0,right:1,bottom:0,left:1},infoMark:!0,zScores:(o=d3.mean([].concat(m(h.values()))),i=d3.deviation([].concat(m(h.values()))),a=(15e4-o)/i,u.features.forEach(function(e){0<e.properties.med_income?(e.properties.med_incomeZ=(e.properties.med_income-o)/i,r=e.properties.med_incomeZ<r||void 0===r?e.properties.med_incomeZ:r,n=e.properties.med_incomeZ>n||void 0===n?e.properties.med_incomeZ:n):e.properties.med_incomeZ=null}),n=n<a?n:a,{min:-2.33,max:2.33,mean:o,sd:i}),min:function(){return this.zScores.min},heightToWidth:.05,container:"#income-bar",data:u.features,numerator:function(e){if(0===e.size)return this.min;var r=new Set,n=[];return e.forEach(function(e){var t=p.get(e);r.has(t.cen_tract)||(r.add(t.cen_tract),n.push(t.med_incomeZ))}),d3.mean(n)},denominator:function(){return this.zScores.max},textFunction:function(e){return 0===y.size?"none in view":"$"+d3.format(",.0f")(this.zScores.mean+this.zScores.sd*e)+" (z = "+d3.format(".2f")(e)+")"}}),new b.Bars.Bar({title:"Average marginal cost for lower deductible",margin:{top:0,right:1,bottom:0,left:1},zScores:v("ddp",null,null,[]),min:function(){return this.zScores.min},heightToWidth:.05,container:"#marginal-bar",data:u.features,numerator:function(t){return 0===t.size?this.min:(this.filteredData=this.data.filter(function(e){return t.has(e.properties.id)}),d3.mean(this.filteredData,function(e){return e.properties.ddpZ}))},denominator:function(){return this.zScores.max},textFunction:function(e){return 0===y.size?"none in view":"$"+d3.format(",.0f")(this.zScores.mean+this.zScores.sd*e)+" (z = "+d3.format(".2f")(e)+")"}})),d++;var c=d3.selectAll(".has-info-mark").append("svg").datum({mapfeature:"This map represents new flood insurance policies initiated between June and December 2014. The analysis in the related paper revolves around the decision whether to pay more for a lower deductible.",deductiblebar:"The standard deductible is $5,000; anything less is consider a low deductible.",valuebar:"This calculation ignores extreme outliers (values above $20M) which are likely due to data errors; it also ignores overrepresented values of $250,000, the majority of which are likely due to reporting errors.",incomebar:"Median household income is a property of the census tract in which the policyholder resides. Each census tract with an associated policy in view is counted once.",coveragebar:"Flood coverage is limited to $250,000."}).attr("width","12px").attr("viewBox","0 0 12 12").attr("class","info-mark").append("g");c.call(l).on("mouseenter",function(e){l.show.call(this,e)}).on("click",function(e){d3.event.stopPropagation(),l.show.call(this,e)}).on("mouseleave",l.hide),d3.select("#map-feature").on("click",function(){d3.selectAll(".d3-tip").style("opacity",0)}),c.append("circle").attr("class","info-mark-background").attr("cx",6).attr("cy",6).attr("r",6),c.append("path").attr("class","info-mark-foreground").attr("d","M5.231,7.614V6.915c0-0.364,0.084-0.702,0.254-1.016c0.169-0.313,0.355-0.613,0.559-0.902\n\t\t\t\t\t\t\tc0.203-0.287,0.39-0.564,0.559-0.831C6.772,3.9,6.857,3.631,6.857,3.36c0-0.195-0.081-0.357-0.242-0.489\n\t\t\t\t\t\t\tC6.455,2.74,6.268,2.674,6.057,2.674c-0.153,0-0.288,0.034-0.407,0.102c-0.118,0.068-0.222,0.155-0.311,0.26\n\t\t\t\t\t\t\tC5.25,3.142,5.177,3.261,5.117,3.392c-0.06,0.131-0.097,0.264-0.114,0.4l-1.46-0.407C3.704,2.75,4.008,2.261,4.457,1.919\n\t\t\t\t\t\t\tc0.448-0.343,1.016-0.515,1.701-0.515c0.313,0,0.607,0.044,0.882,0.133C7.316,1.626,7.56,1.756,7.771,1.925\n\t\t\t\t\t\t\tC7.982,2.095,8.15,2.306,8.272,2.56c0.123,0.254,0.185,0.546,0.185,0.876c0,0.423-0.096,0.785-0.286,1.085\n\t\t\t\t\t\t\tc-0.191,0.301-0.4,0.586-0.629,0.857C7.314,5.65,7.104,5.923,6.914,6.198S6.628,6.789,6.628,7.144v0.47H5.231z M5.079,10.699V8.896\n\t\t\t\t\t\t\th1.752v1.803H5.079z"),g()});var y=new Set;return n.on("moveend",function(){a()}),n.on("zoomend",function(e){a(),d3.select("#size-legend").classed("show",n.getZoom()>=r)}),n.on("mousemove","points-data-driven",function(e){}),n}function g(){d<2||(a(),t.addSourceAndLayers.call(n,{name:"policies",type:"geojson",data:u,cluster:!0,clusterRadius:.5},[{id:"cluster-count",type:"symbol",source:"policies",filter:["has","point_count"],minzoom:6,layout:{"text-field":"{point_count_abbreviated}","text-size":12},paint:{"text-color":"#ffffff"}}]))}function v(t){1<arguments.length&&void 0!==arguments[1]&&arguments[1];var r,n,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],a=d3.mean(u.features,function(e){return null===o?-1===i.indexOf(e.properties[t])?e.properties[t]:null:e.properties[t]<=o?-1===i.indexOf(e.properties[t])?e.properties[t]:null:void 0}),s=d3.deviation(u.features,function(e){return null===o?-1===i.indexOf(e.properties[t])?e.properties[t]:null:e.properties[t]<=o?-1===i.indexOf(e.properties[t])?e.properties[t]:null:void 0});return u.features.forEach(function(e){o&&e.properties[t]>o||-1!==i.indexOf(e.properties[t])?e.properties[t+"Z"]=null:(e.properties[t+"Z"]=(e.properties[t]-a)/s,r=e.properties[t+"Z"]<r||void 0===r?e.properties[t+"Z"]:r,n=e.properties[t+"Z"]>n||void 0===n?e.properties[t+"Z"]:n)}),{min:r=-(n=2.33),max:n,mean:a,sd:s}}function a(){!function(){y.clear();var t=n.getBounds();u.features.forEach(function(e){e.properties.longitude>=t._sw.lng&&e.properties.longitude<=t._ne.lng&&e.properties.latitude>=t._sw.lat&&e.properties.latitude<=t._ne.lat&&y.add(e.properties.id)})}(),f.forEach(function(e){return e.update(y)})}}()},{"../js-exports/Bars":2,"../js-vendor/d3-tip":3,"../js-vendor/polyfills":4,"mapbox-helper":5}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n;r.Bars=((n=function(e){this.setup(e)}).prototype={setup:function(e){var t=this,r="0 0 100 "+Math.round(100*e.heightToWidth);this.container=e.container,this.margin=e.margin,this.width=100-this.margin.left-this.margin.right,this.height=100*e.heightToWidth-this.margin.top-this.margin.bottom,this.title=e.title,this.infoMark=e.infoMark||!1,this.comparator=e.comparator,this.truncateRight=e.truncateRight||!1,this.backgroundColor=e.backgroundColor||"gray",this.data=e.data,this.numerator=e.numerator,this.denominator=e.denominator,this.textFunction=e.textFunction,this.zScores=e.zScores||null,this.min=e.min?e.min.call(this):0,d3.select(this.container).append("span").classed("figure-title",!0).classed("has-info-mark",function(){return t.infoMark}).text(this.title),this.svg=d3.select(this.container).append("div").attr("class","svg-wrapper").append("svg").attr("width","100%").attr("xmlns","http://www.w3.org/2000/svg").attr("version","1.1").attr("viewBox",r).append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.background=this.svg.append("line").classed("background-line-"+this.backgroundColor,!0).attr("x0",0).attr("y0",0).attr("x1",this.width).attr("y1",0),this.line=this.svg.append("line").classed("foreground-line",!0).attr("x0",0).attr("y0",0).attr("x1",0).attr("y1",0),this.text=d3.select(this.container).append("span").attr("class","value")},update:function(e){var t=this,r=this.numerator(e),n=this.denominator(e);d3.select(this.container).classed("overflow",n<r),this.truncateRight?n=this.min=0-n:this.min<0&&0<n&&(Math.abs(this.min)<n?this.min=0-n:n=0-this.min),this.scale=d3.scaleLinear().domain([this.min,n]).range([0,this.width]).clamp(!0),this.line.transition().duration(200).attr("x1",function(){return t.scale(r)}),this.text.text(function(){return t.textFunction(r,n)})}},{Bar:n})},{}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.d3Tip=(d3.functor=function(e){return"function"==typeof e?e:function(){return e}},void(d3.tip=function(){var u=function(){return"n"},l=function(){return[0,0]},f=function(){return" "},r=e(),n=null,c=null,p=null;function d(e){var t;n="svg"===(t=(t=e).node()).tagName.toLowerCase()?t:t.ownerSVGElement,c=n.createSVGPoint(),document.body.appendChild(r)}d.show=function(){var e=Array.prototype.slice.call(arguments);e[e.length-1]instanceof SVGElement&&(p=e.pop());var t,r=f.apply(this,e),n=l.apply(this,e),o=u.apply(this,e),i=g(),a=y.length,s=document.documentElement.scrollTop||document.body.scrollTop,c=document.documentElement.scrollLeft||document.body.scrollLeft;for(i.html(r).style("position","absolute").style("opacity",1).style("pointer-events","all");a--;)i.classed(y[a],!1);return t=h[o].apply(this),i.classed(o,!0).style("top",t.top+n[0]+s+"px").style("left",t.left+n[1]+c+"px"),d},d.hide=function(){return g().style("opacity",0).style("pointer-events","none"),d},d.attr=function(e,t){if(arguments.length<2&&"string"==typeof e)return g().attr(e);var r=Array.prototype.slice.call(arguments);return d3.selection.prototype.attr.apply(g(),r),d},d.style=function(e,t){if(arguments.length<2&&"string"==typeof e)return g().style(e);var r=Array.prototype.slice.call(arguments);if(1===r.length){var n=r[0];Object.keys(n).forEach(function(e){return d3.selection.prototype.style.apply(g(),[e,n[e]])})}return d},d.direction=function(e){return arguments.length?(u=null==e?e:d3.functor(e),d):u},d.offset=function(e){return arguments.length?(l=null==e?e:d3.functor(e),d):l},d.html=function(e){return arguments.length?(f=null==e?e:d3.functor(e),d):f},d.destroy=function(){return r&&(g().remove(),r=null),d};var h={n:function(){var e=t();return{top:e.n.y-r.offsetHeight,left:e.n.x-r.offsetWidth/2}},s:function(){var e=t();return{top:e.s.y,left:e.s.x-r.offsetWidth/2}},e:function(){var e=t();return{top:e.e.y-r.offsetHeight/2,left:e.e.x}},w:function(){var e=t();return{top:e.w.y-r.offsetHeight/2,left:e.w.x-r.offsetWidth}},nw:function(){var e=t();return{top:e.nw.y-r.offsetHeight,left:e.nw.x-r.offsetWidth}},ne:function(){var e=t();return{top:e.ne.y-r.offsetHeight,left:e.ne.x}},sw:function(){var e=t();return{top:e.sw.y,left:e.sw.x-r.offsetWidth}},se:function(){var e=t();return{top:e.se.y,left:e.e.x}}},y=Object.keys(h);function e(){var e=d3.select(document.createElement("div"));return e.style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box"),e.node()}function g(){return null===r&&(r=e(),document.body.appendChild(r)),d3.select(r)}function t(){var r=p||d3.event.target;for(function t(){try{r.getBBox()}catch(e){r=r.parentNode,t()}}();void 0===r.getScreenCTM;)r=r.parentNode;var e={},t=r.getScreenCTM(),n=r.getBBox(),o=n.width,i=n.height,a=n.x,s=n.y;return c.x=a,c.y=s,e.nw=c.matrixTransform(t),c.x+=o,e.ne=c.matrixTransform(t),c.y+=i,e.se=c.matrixTransform(t),c.x-=o,e.sw=c.matrixTransform(t),c.y-=i/2,e.w=c.matrixTransform(t),c.x+=o,e.e=c.matrixTransform(t),c.x-=o/2,c.y-=i/2,e.n=c.matrixTransform(t),c.y+=i,e.s=c.matrixTransform(t),e}return d}))},{}],4:[function(e,t,$){(function(e){"use strict";Object.defineProperty($,"__esModule",{value:!0});var r,K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};$.MapValues=void("undefined"!=typeof Map&&(Map.prototype.values=Map.prototype.values||function(){var t=[];return this.forEach(function(e){t.push(e)}),t})),$.SVGFocus=("focus"in SVGElement.prototype==0&&(SVGElement.prototype.focus=HTMLElement.prototype.focus),void("blur"in SVGElement.prototype==0&&(SVGElement.prototype.blur=HTMLElement.prototype.blur))),$.SVGInnerHTML=(r=function e(t,r){var n=t.nodeType;if(3==n)r.push(t.textContent.replace(/&/,"&amp;").replace(/</,"&lt;").replace(">","&gt;"));else if(1==n){if(r.push("<",t.tagName),t.hasAttributes())for(var o=t.attributes,i=0,a=o.length;i<a;++i){var s=o.item(i);r.push(" ",s.name,"='",s.value,"'")}if(t.hasChildNodes()){r.push(">");var c=t.childNodes;for(i=0,a=c.length;i<a;++i)e(c.item(i),r);r.push("</",t.tagName,">")}else r.push("/>")}else{if(8!=n)throw"Error serializing XML. Unhandled node of type: "+n;r.push("\x3c!--",t.nodeValue,"--\x3e")}},void("innerHTML"in SVGElement.prototype==0&&(Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){for(var e=[],t=this.firstChild;t;)r(t,e),t=t.nextSibling;return e.join("")},set:function(e){for(;this.firstChild;)this.removeChild(this.firstChild);try{var t=new DOMParser;t.async=!1;for(var r='<svg xmlns="http://www.w3.org/2000/svg">'+e+"</svg>",n=t.parseFromString(r,"text/xml").documentElement.firstChild;n;)this.appendChild(this.ownerDocument.importNode(n,!0)),n=n.nextSibling}catch(e){throw new Error("Error parsing XML string")}}}),Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(e){this.innerHTML=e}})))),$.arrayFind=void(Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n=arguments[1],o=0;o<r;){var i=t[o];if(e.call(n,i,o,t))return i;o++}}})),$.reflect=function(e){function o(e){return/^(get|set|value|writable|enumerable|configurable)$/.test(e)}function i(e){if(Object(e)!==e)throw new TypeError("property descriptor should be an Object, given: "+e);var t={};if("enumerable"in e&&(t.enumerable=!!e.enumerable),"configurable"in e&&(t.configurable=!!e.configurable),"value"in e&&(t.value=e.value),"writable"in e&&(t.writable=!!e.writable),"get"in e){var r=e.get;if(void 0!==r&&"function"!=typeof r)throw new TypeError("property descriptor 'get' attribute must be callable or undefined, given: "+r);t.get=r}if("set"in e){var n=e.set;if(void 0!==n&&"function"!=typeof n)throw new TypeError("property descriptor 'set' attribute must be callable or undefined, given: "+n);t.set=n}if(("get"in t||"set"in t)&&("value"in t||"writable"in t))throw new TypeError("property descriptor cannot be both a data and an accessor descriptor: "+e);return t}function f(e){return void 0!==e&&("get"in e||"set"in e)}function l(e){return void 0!==e&&("value"in e||"writable"in e)}function a(e){return void 0!==e&&(!f(e)&&!l(e))}function s(e){return!("get"in e||"set"in e||"value"in e||"writable"in e||"enumerable"in e||"configurable"in e)}function c(e,t){return u(e.get,t.get)&&u(e.set,t.set)&&u(e.value,t.value)&&u(e.writable,t.writable)&&u(e.enumerable,t.enumerable)&&u(e.configurable,t.configurable)}function u(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function p(e){if(void 0!==e){var t,r=(a(t=i(e))||l(t)?("value"in t||(t.value=void 0),"writable"in t||(t.writable=!1)):("get"in t||(t.get=void 0),"set"in t||(t.set=void 0)),"enumerable"in t||(t.enumerable=!1),"configurable"in t||(t.configurable=!1),t);for(var n in e)o(n)||Object.defineProperty(r,n,{value:e[n],writable:!0,enumerable:!0,configurable:!0});return r}}function d(e){var t=i(e);for(var r in e)o(r)||Object.defineProperty(t,r,{value:e[r],writable:!0,enumerable:!0,configurable:!0});return t}"undefined"==typeof WeakMap&&(e.WeakMap=function(){},e.WeakMap.prototype={get:function(e){},set:function(e,t){throw new Error("WeakMap not supported")}});var h,n,y,r=Object.preventExtensions,g=(Object.seal,Object.freeze,Object.isExtensible),v=(Object.isSealed,Object.isFrozen,Object.getPrototypeOf),b=Object.getOwnPropertyDescriptor,m=Object.defineProperty,w=Object.defineProperties,O=Object.keys,x=Object.getOwnPropertyNames,t=Object.getOwnPropertySymbols,j=Object.assign,E=Array.isArray,P=Array.prototype.concat,T=Object.prototype.isPrototypeOf,S=Object.prototype.hasOwnProperty;function z(e,t){return{}.hasOwnProperty.call(t,e)}function k(e,t){var r=Object.getOwnPropertyDescriptor(t,e);return void 0!==r&&!1===r.configurable}function _(e){return void 0!==e&&!1===e.configurable}function M(e,t,r){if(void 0===t&&!1===e)return!1;if(void 0===t&&!0===e)return!0;if(s(r))return!0;if(c(t,r))return!0;if(!1===t.configurable){if(!0===r.configurable)return!1;if("enumerable"in r&&r.enumerable!==t.enumerable)return!1}if(a(r))return!0;if(l(t)!==l(r))return!1!==t.configurable;if(l(t)&&l(r)){if(!1===t.configurable){if(!1===t.writable&&!0===r.writable)return!1;if(!1===t.writable&&"value"in r&&!u(r.value,t.value))return!1}return!0}if(f(t)&&f(r)&&!1===t.configurable){if("set"in r&&!u(r.set,t.set))return!1;if("get"in r&&!u(r.get,t.get))return!1}return!0}function A(e,t){var r=y(e),n=void 0;if("sealed"===t)for(var o=+r.length,i=0;i<o;i++){a=String(r[i]);try{Object.defineProperty(e,a,{configurable:!1})}catch(e){void 0===n&&(n=e)}}else{var a;for(o=+r.length,i=0;i<o;i++){a=String(r[i]);try{var s,c=Object.getOwnPropertyDescriptor(e,a);if(void 0!==c)s=f(c)?{configurable:!1}:{configurable:!1,writable:!1},Object.defineProperty(e,a,s)}catch(e){void 0===n&&(n=e)}}}if(void 0!==n)throw n;return Z.preventExtensions(e)}function D(e,t){if(h(e))return!1;for(var r,n,o=y(e),i=void 0,a=!1,s=!1,c=+o.length,u=0;u<c;u++){r=String(o[u]);try{n=Object.getOwnPropertyDescriptor(e,r),a=a||n.configurable,l(n)&&(s=s||n.writable)}catch(e){void 0===i&&(i=e,a=!0)}}if(void 0!==i)throw i;return("frozen"!==t||!0!==s)&&!0!==a}function C(e,t){this.target=e,this.handler=t}C.prototype={getTrap:function(e){var t=this.handler[e];if(void 0!==t){if("function"!=typeof t)throw new TypeError(e+" trap is not callable: "+t);return t}},getOwnPropertyDescriptor:function(e){var t=this.getTrap("getOwnPropertyDescriptor");if(void 0===t)return Z.getOwnPropertyDescriptor(this.target,e);e=String(e);var r=t.call(this.handler,this.target,e);r=p(r);var n=Object.getOwnPropertyDescriptor(this.target,e),o=Object.isExtensible(this.target);if(void 0!==r){if(!o&&void 0===n)throw new TypeError("cannot report a new own property '"+e+"' on a non-extensible object");if(void 0!==e&&!M(o,n,r))throw new TypeError("cannot report incompatible property descriptor for property '"+e+"'");if(!1===r.configurable){if(void 0===n||!0===n.configurable)throw new TypeError("cannot report a non-configurable descriptor for configurable or non-existent property '"+e+"'");if("writable"in r&&!1===r.writable&&!0===n.writable)throw new TypeError("cannot report non-configurable, writable property '"+e+"' as non-configurable, non-writable")}return r}if(_(n))throw new TypeError("cannot report non-configurable property '"+e+"' as non-existent");if(!o&&void 0!==n)throw new TypeError("cannot report existing own property '"+e+"' as non-existent on a non-extensible object")},getPropertyDescriptor:function(t){var r=this;if(r.has(t))return{get:function(){return r.get(this,t)},set:function(e){if(r.set(this,t,e))return e;throw new TypeError("failed assignment to "+t)},enumerable:!0,configurable:!0}},defineProperty:function(e,t){var r=this.getTrap("defineProperty");if(void 0===r)return Z.defineProperty(this.target,e,t);e=String(e);var n=d(t),o=r.call(this.handler,this.target,e,n);if(!0===(o=!!o)){var i=Object.getOwnPropertyDescriptor(this.target,e),a=Object.isExtensible(this.target);if(!a&&void 0===i)throw new TypeError("cannot successfully add a new property '"+e+"' to a non-extensible object");if(void 0!==i){if(!M(a,i,t))throw new TypeError("cannot define incompatible property descriptor for property '"+e+"'");if(l(i)&&!1===i.configurable&&!0===i.writable&&!1===t.configurable&&!1===t.writable)throw new TypeError("cannot successfully define non-configurable, writable  property '"+e+"' as non-configurable, non-writable")}if(!1===t.configurable&&!_(i))throw new TypeError("cannot successfully define a non-configurable descriptor for configurable or non-existent property '"+e+"'")}return o},preventExtensions:function(){var e=this.getTrap("preventExtensions");if(void 0===e)return Z.preventExtensions(this.target);var t=e.call(this.handler,this.target);if((t=!!t)&&h(this.target))throw new TypeError("can't report extensible object as non-extensible: "+this.target);return t},delete:function(e){var t=this.getTrap("deleteProperty");if(void 0===t)return Z.deleteProperty(this.target,e);e=String(e);var r,n=t.call(this.handler,this.target,e);if(!0===(n=!!n)){if(void 0!==(r=Object.getOwnPropertyDescriptor(this.target,e))&&!1===r.configurable)throw new TypeError("property '"+e+"' is non-configurable and can't be deleted");if(void 0!==r&&!h(this.target))throw new TypeError("cannot successfully delete existing property '"+e+"' on a non-extensible object")}return n},getOwnPropertyNames:function(){return this.ownKeys()},ownKeys:function(){var e=this.getTrap("ownKeys");if(void 0===e)return Z.ownKeys(this.target);for(var t=e.call(this.handler,this.target),r=Object.create(null),n=+t.length,o=new Array(n),i=0;i<n;i++){var a=String(t[i]);if(!Object.isExtensible(this.target)&&!z(a,this.target))throw new TypeError("ownKeys trap cannot list a new property '"+a+"' on a non-extensible object");r[a]=!0,o[i]=a}var s=y(this.target),c=this.target;return s.forEach(function(e){if(!r[e]){if(k(e,c))throw new TypeError("ownKeys trap failed to include non-configurable property '"+e+"'");if(!Object.isExtensible(c)&&z(e,c))throw new TypeError("ownKeys trap cannot report existing own property '"+e+"' as non-existent on a non-extensible object")}}),o},isExtensible:function(){var e=this.getTrap("isExtensible");if(void 0===e)return Z.isExtensible(this.target);var t=e.call(this.handler,this.target);t=!!t;var r=h(this.target);if(t!==r)throw t?new TypeError("cannot report non-extensible object as extensible: "+this.target):new TypeError("cannot report extensible object as non-extensible: "+this.target);return r},getPrototypeOf:function(){var e=this.getTrap("getPrototypeOf");if(void 0===e)return Z.getPrototypeOf(this.target);var t=e.call(this.handler,this.target);if(!h(this.target)&&!u(t,n(this.target)))throw new TypeError("prototype value does not match: "+this.target);return t},setPrototypeOf:function(e){var t=this.getTrap("setPrototypeOf");if(void 0===t)return Z.setPrototypeOf(this.target,e);var r=t.call(this.handler,this.target,e);if((r=!!r)&&!h(this.target)&&!u(e,n(this.target)))throw new TypeError("prototype value does not match: "+this.target);return r},getPropertyNames:function(){throw new TypeError("getPropertyNames trap is deprecated")},has:function(e){var t=this.getTrap("has");if(void 0===t)return Z.has(this.target,e);e=String(e);var r=t.call(this.handler,this.target,e);if(!1===(r=!!r)){if(k(e,this.target))throw new TypeError("cannot report existing non-configurable own property '"+e+"' as a non-existent property");if(!Object.isExtensible(this.target)&&z(e,this.target))throw new TypeError("cannot report existing own property '"+e+"' as non-existent on a non-extensible object")}return r},get:function(e,t){var r=this.getTrap("get");if(void 0===r)return Z.get(this.target,t,e);t=String(t);var n=r.call(this.handler,this.target,t,e),o=Object.getOwnPropertyDescriptor(this.target,t);if(void 0!==o)if(l(o)&&!1===o.configurable&&!1===o.writable){if(!u(n,o.value))throw new TypeError("cannot report inconsistent value for non-writable, non-configurable property '"+t+"'")}else if(f(o)&&!1===o.configurable&&void 0===o.get&&void 0!==n)throw new TypeError("must report undefined for non-configurable accessor property '"+t+"' without getter");return n},set:function(e,t,r){var n=this.getTrap("set");if(void 0===n)return Z.set(this.target,t,r,e);t=String(t);var o=n.call(this.handler,this.target,t,r,e);if(!0===(o=!!o)){var i=Object.getOwnPropertyDescriptor(this.target,t);if(void 0!==i)if(l(i)&&!1===i.configurable&&!1===i.writable){if(!u(r,i.value))throw new TypeError("cannot successfully assign to a non-writable, non-configurable property '"+t+"'")}else if(f(i)&&!1===i.configurable&&void 0===i.set)throw new TypeError("setting a property '"+t+"' that has  only a getter")}return o},enumerate:function(){var e=this.getTrap("enumerate");if(void 0===e){for(var t,r=[],n=(t=Z.enumerate(this.target)).next();!n.done;)r.push(String(n.value)),n=t.next();return r}if(null==(t=e.call(this.handler,this.target))||void 0===t.next)throw new TypeError("enumerate trap should return an iterator, got: "+t);var o=Object.create(null);for(r=[],n=t.next();!n.done;){var i=String(n.value);if(o[i])throw new TypeError("enumerate trap cannot list a duplicate property '"+i+"'");o[i]=!0,r.push(i),n=t.next()}var a=Object.keys(this.target),s=this.target;return a.forEach(function(e){if(!o[e]){if(k(e,s))throw new TypeError("enumerate trap failed to include non-configurable enumerable property '"+e+"'");if(!Object.isExtensible(s)&&z(e,s))throw new TypeError("cannot report existing own property '"+e+"' as non-existent on a non-extensible object")}}),r},iterate:C.prototype.enumerate,apply:function(e,t,r){var n=this.getTrap("apply");if(void 0===n)return Z.apply(e,t,r);if("function"==typeof this.target)return n.call(this.handler,e,t,r);throw new TypeError("apply: "+e+" is not a function")},construct:function(e,t,r){var n=this.getTrap("construct");if(void 0===n)return Z.construct(e,t,r);if("function"!=typeof e)throw new TypeError("new: "+e+" is not a function");if(void 0===r)r=e;else if("function"!=typeof r)throw new TypeError("new: "+r+" is not a function");return n.call(this.handler,e,t,r)}};var B=new WeakMap;function F(e,t){return"object"===(n=void 0===(r=t)?"undefined":K(r))&&null!==r||"function"===n?e.get(t):void 0;var r,n}function L(r){return function e(){var t=F(B,this);return void 0!==t?e.call(t.target):r.call(this)}}Object.preventExtensions=function(e){var t=B.get(e);if(void 0!==t){if(t.preventExtensions())return e;throw new TypeError("preventExtensions on "+e+" rejected")}return r(e)},Object.seal=function(e){return A(e,"sealed"),e},Object.freeze=function(e){return A(e,"frozen"),e},Object.isExtensible=h=function(e){var t=B.get(e);return void 0!==t?t.isExtensible():g(e)},Object.isSealed=function(e){return D(e,"sealed")},Object.isFrozen=function(e){return D(e,"frozen")},Object.getPrototypeOf=n=function(e){var t=B.get(e);return void 0!==t?t.getPrototypeOf():v(e)},Object.getOwnPropertyDescriptor=function(e,t){var r=B.get(e);return void 0!==r?r.getOwnPropertyDescriptor(t):b(e,t)},Object.defineProperty=function(e,t,r){var n=B.get(e);if(void 0!==n){var o=d(r);if(!1===n.defineProperty(t,o))throw new TypeError("can't redefine property '"+t+"'");return e}return m(e,t,r)},Object.defineProperties=function(e,t){var r=B.get(e);if(void 0!==r){for(var n=Object.keys(t),o=0;o<n.length;o++){var i=n[o],a=d(t[i]);if(!1===r.defineProperty(i,a))throw new TypeError("can't redefine property '"+i+"'")}return e}return w(e,t)},Object.keys=function(e){var t=B.get(e);if(void 0!==t){for(var r=t.ownKeys(),n=[],o=0;o<r.length;o++){var i=String(r[o]),a=Object.getOwnPropertyDescriptor(e,i);void 0!==a&&!0===a.enumerable&&n.push(i)}return n}return O(e)},Object.getOwnPropertyNames=y=function(e){var t=B.get(e);return void 0!==t?t.ownKeys():x(e)},void 0!==t&&(Object.getOwnPropertySymbols=function(e){return void 0!==B.get(e)?[]:t(e)}),void 0!==j&&(Object.assign=function(e){for(var t=!0,r=0;r<arguments.length;r++){if(void 0!==B.get(arguments[r])){t=!1;break}}if(t)return j.apply(Object,arguments);if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),o=1;o<arguments.length;o++){var i=arguments[o];if(null!=i)for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])}return n}),Object.prototype.valueOf=L(Object.prototype.valueOf),Object.prototype.toString=L(Object.prototype.toString),Function.prototype.toString=L(Function.prototype.toString),Date.prototype.toString=L(Date.prototype.toString),Object.prototype.isPrototypeOf=function(e){for(;;){var t=F(B,e);if(void 0===t)return T.call(this,e);if(null===(e=t.getPrototypeOf()))return!1;if(u(e,this))return!0}},Array.isArray=function(e){var t=F(B,e);return void 0!==t?Array.isArray(t.target):E(e)},Array.prototype.concat=function(){for(var e,t,r,n=0;n<arguments.length;n++)t=arguments[n],void 0!==(r=F(B,t))&&Array.isArray(r.target)&&(e=arguments[n].length,arguments[n]=Array.prototype.slice.call(arguments[n],0,e));return P.apply(this,arguments)};var N=Object.setPrototypeOf,W=function(){var e=b(Object.prototype,"__proto__");if(void 0===e||"function"!=typeof e.set)return function(){throw new TypeError("setPrototypeOf not supported on this platform")};try{e.set.call({},{})}catch(e){return function(){throw new TypeError("setPrototypeOf not supported on this platform")}}return m(Object.prototype,"__proto__",{set:function(e){return Object.setPrototypeOf(this,Object(e))}}),e.set}();Object.setPrototypeOf=function(e,t){var r=B.get(e);if(void 0!==r){if(r.setPrototypeOf(t))return e;throw new TypeError("proxy rejected prototype mutation")}if(!h(e))throw new TypeError("can't set prototype on non-extensible object: "+e);if(N)return N(e,t);if(Object(t)!==t||null===t)throw new TypeError("Object prototype may only be an Object or null: "+t);return W.call(e,t),e},Object.prototype.hasOwnProperty=function(e){var t=F(B,this);return void 0!==t?void 0!==t.getOwnPropertyDescriptor(e):S.call(this,e)};var Z=e.Reflect={getOwnPropertyDescriptor:function(e,t){return Object.getOwnPropertyDescriptor(e,t)},defineProperty:function(e,t,r){var n=B.get(e);if(void 0!==n)return n.defineProperty(e,t,r);var o=Object.getOwnPropertyDescriptor(e,t),i=Object.isExtensible(e);if(void 0===o&&!1===i)return!1;if(void 0===o&&!0===i)return Object.defineProperty(e,t,r),!0;if(s(r))return!0;if(c(o,r))return!0;if(!1===o.configurable){if(!0===r.configurable)return!1;if("enumerable"in r&&r.enumerable!==o.enumerable)return!1}if(a(r));else if(l(o)!==l(r)){if(!1===o.configurable)return!1}else if(l(o)&&l(r)){if(!1===o.configurable){if(!1===o.writable&&!0===r.writable)return!1;if(!1===o.writable&&"value"in r&&!u(r.value,o.value))return!1}}else if(f(o)&&f(r)&&!1===o.configurable){if("set"in r&&!u(r.set,o.set))return!1;if("get"in r&&!u(r.get,o.get))return!1}return Object.defineProperty(e,t,r),!0},deleteProperty:function(e,t){var r=B.get(e);if(void 0!==r)return r.delete(t);var n=Object.getOwnPropertyDescriptor(e,t);return void 0===n||!0===n.configurable&&(delete e[t],!0)},getPrototypeOf:function(e){return Object.getPrototypeOf(e)},setPrototypeOf:function(e,t){var r=B.get(e);if(void 0!==r)return r.setPrototypeOf(t);if(Object(t)!==t||null===t)throw new TypeError("Object prototype may only be an Object or null: "+t);if(!h(e))return!1;if(u(Object.getPrototypeOf(e),t))return!0;if(N)try{return N(e,t),!0}catch(e){return!1}return W.call(e,t),!0},preventExtensions:function(e){var t=B.get(e);return void 0!==t?t.preventExtensions():(r(e),!0)},isExtensible:function(e){return Object.isExtensible(e)},has:function(e,t){return t in e},get:function(e,t,r){r=r||e;var n=B.get(e);if(void 0!==n)return n.get(r,t);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var i=Object.getPrototypeOf(e);if(null===i)return;return Z.get(i,t,r)}return l(o)?o.value:void 0!==o.get?o.get.call(r):void 0},set:function(e,t,r,n){n=n||e;var o=B.get(e);if(void 0!==o)return o.set(n,t,r);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var a=Object.getPrototypeOf(e);if(null!==a)return Z.set(a,t,r,n);i={value:void 0,writable:!0,enumerable:!0,configurable:!0}}if(f(i)){var s=i.set;return void 0!==s&&(s.call(n,r),!0)}if(!1===i.writable)return!1;var c=Object.getOwnPropertyDescriptor(n,t);if(void 0!==c){var u={value:r,writable:c.writable,enumerable:c.enumerable,configurable:c.configurable};return Object.defineProperty(n,t,u),!0}if(!Object.isExtensible(n))return!1;var l={value:r,writable:!0,enumerable:!0,configurable:!0};return Object.defineProperty(n,t,l),!0},enumerate:function(e){var t,r=B.get(e);if(void 0!==r)t=r.enumerate(r.target);else for(var n in t=[],e)t.push(n);var o=+t.length,i=0;return{next:function(){return i===o?{done:!0}:{done:!1,value:t[i++]}}}},ownKeys:function(e){return y(e)},apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},construct:function(e,t,r){var n=B.get(e);if(void 0!==n)return n.construct(n.target,t,r);if("function"!=typeof e)throw new TypeError("target is not a function: "+e);if(void 0===r)r=e;else if("function"!=typeof r)throw new TypeError("newTarget is not a function: "+e);return new(Function.prototype.bind.apply(r,[null].concat(t)))}};if("undefined"!=typeof Proxy&&void 0!==Proxy.create){var V=Proxy.create,G=Proxy.createFunction,H=V({get:function(){throw new TypeError("proxy is revoked")}});e.Proxy=function(t,e){if(Object(t)!==t)throw new TypeError("Proxy target must be an Object, given "+t);if(Object(e)!==e)throw new TypeError("Proxy handler must be an Object, given "+e);var r,n=new C(t,e);return r="function"==typeof t?G(n,function(){var e=Array.prototype.slice.call(arguments);return n.apply(t,this,e)},function(){var e=Array.prototype.slice.call(arguments);return n.construct(t,e)}):V(n,Object.getPrototypeOf(t)),B.set(r,n),r},e.Proxy.revocable=function(e,t){var r=new Proxy(e,t);return{proxy:r,revoke:function(){var e=B.get(r);null!==e&&(e.target=null,e.handler=H)}}},e.Proxy.create=V,e.Proxy.createFunction=G}else"undefined"==typeof Proxy&&(e.Proxy=function(e,t){throw new Error("proxies not supported on this platform. On v8/node/iojs, make sure to pass the --harmony_proxies flag")});void 0!==$&&Object.keys(Z).forEach(function(e){$[e]=Z[e]})}(void 0!==$?e:void 0)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,r){"use strict";var a={promises:{},addSourceAndLayers:function(e,t){var n=this,o=e.name;a.promises[e.name]=new Promise(function(t){delete e.name,n.on("render",function e(){this.getSource(o)&&(t(!0),this.off("render",e))}),n.addSource(o,e)});var i=[];return a.promises[o].then(function(){return t.forEach(function(r){i.push(new Promise(function(t){var e=r.beforeLayer?r.beforeLayer:"";delete r.beforeLayer,r.source=o,n.on("render",function e(){this.getLayer(r.id)&&(t(!0),this.off("render",e))}),n.addLayer(r,e)}))}),Promise.all(i)})}};r.addSourceAndLayers=a.addSourceAndLayers},{}]},{},[1]);